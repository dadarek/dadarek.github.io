!function(){window.EventParser=function(){function t(t,e,n){this.interpreter=t,this.dateFilter=e,this.i18n=n}return t.prototype.parse=function(t){var e;return e=this._mapAndFilter(t.items),this._massesAndReconciliations(e).concat(this._otherEvents(e))},t.prototype._otherEvents=function(t){var e,n,i=this;return e=_.filter(t,function(t){return!i.interpreter.isMass(t.name)&&!i.interpreter.isReconciliation(t.name)}),n=_.map(e,function(t){return t.name}),n=this._removeDuplicates(n),_.map(n,function(t){return{name:t,times:i._getEventTimes(e,function(e){return _.str.trim(e.name).toLowerCase()===_.str.trim(t).toLowerCase()})}})},t.prototype._removeDuplicates=function(t){return _.uniq(t,function(t){return _.str.trim(t).toLowerCase()})},t.prototype._massesAndReconciliations=function(t){var e,n,i=this;return e=this._getEventTimes(t,function(t){return i.interpreter.isMass(t.name)}),n=this._getEventTimes(t,function(t){return i.interpreter.isReconciliation(t.name)}),[{name:this.i18n.mass,eventMissing:this.i18n.noMasses,times:e},{name:this.i18n.reconciliation,eventMissing:this.i18n.noReconciliations,times:n}]},t.prototype._getEventTimes=function(t,e){var n,i;return n=_.filter(t,e),i=this._toTimeObject(n)},t.prototype._toTimeObject=function(t){var e,n=this;return e=t,e=_.map(e,function(t){return{start:t.start,end:n.interpreter.isReconciliation(t.name)?t.end:void 0,language:n.interpreter.getLanguage(t.name)}}),e=_.sortBy(e,function(t){return t.start})},t.prototype._mapAndFilter=function(t){var e=this;return t=_.filter(t,function(t){return t.start}),t=_.map(t,function(t){return{name:t.summary,date:t.start.dateTime.substr(0,10),start:t.start.dateTime.substr(11,5),end:t.end.dateTime.substr(11,5),originalStart:t.start.dateTime}}),t=_.filter(t,function(t){return e.dateFilter(t.originalStart)})},t}()}.call(this);